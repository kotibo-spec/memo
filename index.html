<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Local Memo</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body class="fs-medium">

    <!-- ヘッダー -->
    <header id="app-header">
        <div class="header-left">
            <button id="back-btn" class="text-btn hidden">‹ 戻る</button>
            <button id="edit-btn" class="text-btn">編集</button>
        </div>
        <div class="header-center">
            <span id="header-title">計 0</span>
        </div>
        <div class="header-right">
            <button id="search-icon-btn" class="icon-btn">🔍</button>
            <button id="add-btn" class="icon-btn">＋</button>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main id="main-content">
        <!-- メモ一覧 -->
        <div id="view-memo-list" class="view active">
            <div id="memo-search-bar" class="inline-search-bar">
                <input type="text" placeholder="メモを検索...">
            </div>
            <ul id="memo-list-ul" class="list-group"></ul>
        </div>

        <!-- フォルダ一覧 -->
        <div id="view-folder-list" class="view">
            <div id="folder-search-bar" class="inline-search-bar">
                <input type="text" placeholder="フォルダ、メモを検索...">
            </div>
            <ul id="folder-list-ul" class="list-group"></ul>
        </div>

        <!-- フォルダ詳細 -->
        <div id="view-folder-detail" class="view">
            <div id="folder-detail-search-bar" class="inline-search-bar">
                <input type="text" placeholder="このフォルダ内を検索...">
            </div>
            <ul id="folder-detail-ul" class="list-group"></ul>
        </div>

        <!-- 全検索 -->
        <div id="view-search" class="view">
            <div class="search-container">
                <input type="search" id="search-input" placeholder="すべてのメモから検索">
            </div>
            <ul id="search-list-ul" class="list-group"></ul>
        </div>

        <!-- エディタ -->
        <div id="view-editor" class="view">
            <div class="editor-container">
                <!-- タイトル廃止済み -->
                
                <!-- ハイライト用レイヤーと入力エリアを重ねる枠 -->
                <div class="editor-wrapper">
                    <div id="editor-backdrop">
                        <div id="editor-highlights"></div>
                    </div>
                    <textarea id="memo-editor" placeholder="内容を入力..." spellcheck="false"></textarea>
                </div>
            </div>
            
            <!-- エディタ内ツールバー（固定フッター） -->
            <div id="editor-toolbar">
                <button id="tool-search" class="tool-btn">検索</button>
                <button id="tool-replace" class="tool-btn">置換</button>
                <div style="flex:1;"></div>
                <button id="tool-bottom" class="tool-btn">▼</button>
            </div>

            <!-- 検索パネル -->
            <div id="editor-search-panel" class="editor-sub-panel hidden">
                <input type="text" id="editor-search-input" placeholder="検索ワード">
                <button id="editor-search-exec">一括検索</button>
                <button id="editor-panel-close-search" class="close-x">×</button>
            </div>

            <!-- 置換パネル -->
            <div id="editor-replace-panel" class="editor-sub-panel hidden">
                <div style="display:flex; flex-direction:column; width:100%; gap:5px;">
                    <input type="text" id="editor-replace-target" placeholder="検索する文字">
                    <div style="display:flex; gap:5px;">
                        <input type="text" id="editor-replace-with" placeholder="置換後の文字" style="flex:1;">
                        <button id="editor-replace-exec">一括置換</button>
                    </div>
                </div>
                <button id="editor-panel-close-replace" class="close-x" style="align-self: flex-start;">×</button>
            </div>
        </div>

        <!-- 設定 -->
        <div id="view-settings" class="view">
            <div class="settings-container">
                <h2>設定・データ管理</h2>
                <div class="setting-item">
                    <p style="margin-bottom:10px;">文字の大きさ</p>
                    <div class="font-size-group">
                        <button onclick="changeFontSize('small')" id="fs-btn-small">小</button>
                        <button onclick="changeFontSize('medium')" id="fs-btn-medium">中</button>
                        <button onclick="changeFontSize('large')" id="fs-btn-large">大</button>
                    </div>
                </div>
                <div class="setting-item">
                    <button id="sort-toggle">並び順切り替え (現在: <span id="sort-status">更新日時順</span>)</button>
                    <p class="desc">更新日時順 → 作成日時順 → 名前順 の順で切り替わります</p>
                </div>
                <div class="setting-item">
                    <button id="force-update" style="color: var(--accent-color); font-weight:bold;">アプリを最新版に更新</button>
                </div>
            </div>
        </div>
    </main>

    <!-- 編集アクションバー -->
    <div id="edit-action-bar" class="hidden">
        <button id="action-delete" class="danger">削除</button>
        <button id="action-move">移動</button>
        <button id="action-copy">複製</button>
        <button id="action-export">txt書出し</button>
    </div>

    <!-- フッターナビ -->
    <nav id="tab-bar">
        <button class="tab-btn active" data-target="memo">
            <div class="icon">📝</div>
            <span>メモ</span>
        </button>
        <button class="tab-btn" data-target="folder">
            <div class="icon">📁</div>
            <span>フォルダ</span>
        </button>
        <button class="tab-btn" data-target="search">
            <div class="icon">🔍</div>
            <span>検索</span>
        </button>
        <button class="tab-btn" data-target="settings">
            <div class="icon">⚙️</div>
            <span>設定</span>
        </button>
    </nav>

    <!-- モーダル -->
    <div id="modal-overlay" class="hidden"></div>
    <div id="folder-modal" class="modal hidden">
        <h3 id="folder-modal-title">新規フォルダ</h3>
        <input type="text" id="new-folder-name" placeholder="フォルダ名">
        <label>カラー選択</label>
        <div class="color-picker" id="color-picker"></div>
        <div class="modal-actions">
            <button id="modal-cancel">キャンセル</button>
            <button id="modal-save">作成</button>
        </div>
    </div>
    
    <div id="move-modal" class="modal hidden">
        <h3>移動先を選択</h3>
        <ul id="move-target-list"></ul>
        <button id="move-cancel" style="margin-top:10px; width:100%;">キャンセル</button>
    </div>

    <script src="app.js"></script>
</body>
</html>